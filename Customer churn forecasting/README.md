# Прогнозирование оттока клиентов

## Задача

Заказчик - банк, у которого каждый месяц уходят клиенты. Сохранять текущих клиентов выгоднее, чем привлекать новых, поэтому банк решил сосредоточить силы на повышении лояльности клиентов. **Необходимо построить модель, способную по данным клиента спрогнозировать уйдет ли он в ближайшее время**. Исходный датасет уже размечен по целевому признаку.

## Библиотеки и методы

`pandas` `seaborn` `scikit-learn`

- Обработка категориальных переменных (One-Hot Encoding);
- Масштабирование численных признаков (стандартизация);
- Бинарная классификация;
- Обучение на данных со смещенными классами;
- Подбор гиперпараметров;
- Машинное обучение;

## Описание решения

Процесс создания модели машинного обучения, как правило, состоит из нескольких этапов:

1. **Предобработка данных**. Часть признаков в датасете - категориальные. Чтобы алгоритм машинного обучения смог их использовать применил метод преобразования One-Hot Encoding, когда создается несколько новых признаков, соответствующих каждой категории и проставляются значения 0 или 1, в зависимости от отношения объекта к категории. Разделил датасет на обучающий, валидационный и тестовый. Целевой признак представлен непропорционально - 80% пользователей являются действующими клиентами. Для балансировки применил методы увеличения и уменьшения выборки, балансировки весов.

2. **Подбор параметров и обучение модели**. Применял модели случайного леса и логистической регрессии. Для случайного леса подбирал гиперпараметры, контролируя качество на валидационной выборке. Лучшие результаты показала модель случайного леса и метод увеличения выборки. Качество контролировал метрикой F1.

3. **Проверка модели**. Готовую модель тестировал на тестовой выборке и получил значение F1 = 0.61, что выше требуемого заказчиком 0.59.

4. **Вывод**. По результатам работы представил вывод, предложил модель, основанную на алгоритме случайного леса, и метод балансировки с увеличением выборки. Графически представил веса различных признаков - влияние признаков на предсказания модели, и перечислил наиболее важные из них: возраст и количество продуктов.
